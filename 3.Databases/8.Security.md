Having connection strings in the code is very risky, to make it more secure we are going to store them in azure KeyVault
- KeyVault
	- create new<br>![download](https://github.com/salman-cissp/Deploy.WebApp.to.Azure/assets/134168108/1aa7a9c3-739a-421d-9063-7325813038ee)

	- connect via private endpoint<br>![download](https://github.com/salman-cissp/Deploy.WebApp.to.Azure/assets/134168108/05abfa26-6107-498d-91ab-e4a05335a357)

	- Change catalog app code to support keyvault
		![download](https://github.com/salman-cissp/Deploy.WebApp.to.Azure/assets/134168108/ed380d7a-10fd-43a2-94c9-d7a1a3f0d383)

		- add diagnostic setting so we can see who accessed our secrets<br>![download](https://github.com/salman-cissp/Deploy.WebApp.to.Azure/assets/134168108/5f53d960-d1df-4ff5-b917-9b62137218bd)

		- add firewall rule to allow access from local ip<br>![download](https://github.com/salman-cissp/Deploy.WebApp.to.Azure/assets/134168108/e13dff78-adc3-41fc-a4e1-dc8ec3980fcd)

		- define secret to define connection string
			![download](https://github.com/salman-cissp/Deploy.WebApp.to.Azure/assets/134168108/4c70cc5d-bb73-4787-9f2d-a9d7ab4ce080)

			- copy the values from the code. Name is very important, it should match the values in the code<br>![download](https://github.com/salman-cissp/Deploy.WebApp.to.Azure/assets/134168108/04c6b9c9-5bdc-49b3-8965-cb59cba9cf5b)
			- copy vault uri<br>![download](https://github.com/salman-cissp/Deploy.WebApp.to.Azure/assets/134168108/b61602b3-f4b1-4e4b-98bd-5e5e01df5c87)

			- remove the connection string from the code and add the keyvault<br>![download](https://github.com/salman-cissp/Deploy.WebApp.to.Azure/assets/134168108/bd5ea56e-7797-430c-9bf1-a4e9a2412ddc)


			- build
			- test locally, should see this which means it can connect to the db via the keyvault and not the connection string<br>![download](https://github.com/salman-cissp/Deploy.WebApp.to.Azure/assets/134168108/2ce6b96e-31f0-45dc-b074-bdcb67ce96b7)

			- deploy the code to catalog-vm IIS
			- you should get this error, because keyvault has no idea who we are<br>![download](https://github.com/salman-cissp/Deploy.WebApp.to.Azure/assets/134168108/cd7208a9-a271-43b8-842b-3307636c5c10)

				- add managed identity in catalog-vm<br>![download](https://github.com/salman-cissp/Deploy.WebApp.to.Azure/assets/134168108/316cd563-977e-4961-bb2f-829c3f055c3c)

				- give catalog-vm access to secret in keyvault<br>![download](https://github.com/salman-cissp/Deploy.WebApp.to.Azure/assets/134168108/ad402154-51f4-4dee-a82b-a483c99180f1)

				- test locally<br>![download](https://github.com/salman-cissp/Deploy.WebApp.to.Azure/assets/134168108/5fb9ac4d-0c21-48db-99dd-b30efe4061bc)

				- now check via public ip<br>![download](https://github.com/salman-cissp/Deploy.WebApp.to.Azure/assets/134168108/dd5f1e14-55a5-496f-a769-ecf96fcf4a71)

				- check the access history<br>![download](https://github.com/salman-cissp/Deploy.WebApp.to.Azure/assets/134168108/a1e75441-afc6-4097-8ad7-059c8d4e79b6)
![download](https://github.com/salman-cissp/Deploy.WebApp.to.Azure/assets/134168108/864dbef7-0003-4a18-abd8-6ae467930f50)

				
- Security Center
	- check the recommendations<br>![download](https://github.com/salman-cissp/Deploy.WebApp.to.Azure/assets/134168108/20e9d7d6-6492-4548-8133-453e0c212a6b)

	- check the alerts<br>![download](https://github.com/salman-cissp/Deploy.WebApp.to.Azure/assets/134168108/daa08475-e1e3-469d-8434-1892af70628e)

	- check all the inventory being monitor<br>![download](https://github.com/salman-cissp/Deploy.WebApp.to.Azure/assets/134168108/5df2eb0f-83ba-4307-805c-421c27a2b299)

<br><br>


![download](https://github.com/salman-cissp/Deploy.WebApp.to.Azure/assets/134168108/3d3ebfce-5e69-4181-87c1-296be67137a6)
